(()=>{var l={BOTTOM:1,CENTER:2,JUSTIFY:3,LEFT:4,RIGHT:5,STRETCH:6,TOP:7},u={CENTER:1,FLEX_END:2,FLEX_START:3,STRETCH:4},h={COLUMN:1,ROW:2},c={CENTER:1,FLEX_END:2,FLEX_START:3,SPACE_AROUND:4,SPACE_BETWEEN:5};var f={width:"setX",height:"setY"};function A(i,t){let e=f[t],s=t=="width"?p(i):_(i),o=i[t]/2+s;i.items.forEach(r=>{r.setOrigin(0,0);let n=o-r[t]/2;r[e](n)})}function H(i,t){let e=f[t],s=t=="width"?p(i):_(i),o=i[t]-2*i.padding,r=s+i.padding;console.log(i.items),i.items.forEach(n=>{!n._isFlex&&n.type!="Text"&&n.setOrigin(0,0),n.fitContent&&i.flexDirection!=n.flexDirection&&(n.fitContent=!1),n[e](r),n[t]>o&&(o=n[t])}),i.items.forEach(n=>{if(n._isFlex||n.type=="Text")return;let E=t=="width"?[o,n.height]:[n.width,o];x(n,...E)})}function M(i,t){return i=="width"&&t==h.ROW||i=="height"&&t==h.COLUMN}function C(i,t){let e=i.items,s=f[t],o=i._bounds[t=="width"?"right":"bottom"];for(let r=e.length-1;r>=0;r--){let n=e[r];n.setOrigin(0,0),n[s](o-n[t]),M(t,i.flexDirection)&&(o-=n[t]+i.itemsMargin)}}function L(i,t){let e=f[t],s=t=="width"?p(i):_(i),o=T(i),n=i[t]/2+s-o/2;i.items.forEach(E=>{E.setOrigin(0,0),E[e](n),n+=E[t]+i.itemsMargin})}function w(i,t){let e=f[t],s=i._bounds[t=="width"?"left":"top"];i.items.forEach(o=>{o.setOrigin(0,0),o[e](s),M(t,i.flexDirection)&&(s+=o[t]+i.itemsMargin)})}function I(i,t,e){let s=e+i.padding*2;s>i[t]&&(i[t]=s),y(i)}function D(i,t){I(i,"height",t)}function S(i,t){I(i,"width",t)}function k(i,t){let e=O(i),s=f[t],o=i._bounds[t=="width"?"left":"top"];i.items.forEach(r=>{J(i,r,e),r.setOrigin(0,0),r[s](o),o+=r[t]+i.itemsMargin})}function m(i){k(i,"width")}function z(i){k(i,"height")}function P(i,t){let e=i[`_${t}s`].length?Math.max(...i[`_${t}s`]):0;i[t]=e+2*i.padding,y(i)}function U(i){P(i,"height")}function W(i,t){let e=i.width-i.padding*2;t.setWordWrapWidth(e);let s=t.getBounds();t.setFixedSize(e,s.height)}function X(i){P(i,"width")}function O(i){return(i.flexDirection==h.ROW?i.width:i.height)-T(i)-2*i.padding}function T(i){let t=(i.items.length-1)*i.itemsMargin;return i._basisSum+t}function p(i){return i.x-i.width*i.origin.x}function _(i){return i.y-i.height*i.origin.y}function F(i){for(let t=0;t<i.items.length;t++){let e=i.items[t];x(e,e.width,i._heights[t]),e.height=i._heights[t]}}function b(i){for(let t=0;t<i.items.length;t++){let e=i.items[t];x(e,i._widths[t],e.height),e.width=i._widths[t]}}function g(i,t){if(t==l.STRETCH){H(i,"width");return}if(i.flexDirection==h.ROW){let e=O(i);if(!i.fitContent&&(i._growSum&&e>=0||e<0)){m(i);return}}if(t==l.LEFT){if(i.flexDirection==h.ROW){w(i,"width");return}w(i,"width");return}if(t==l.RIGHT){if(i.flexDirection==h.ROW){C(i,"width");return}C(i,"width");return}if(t==l.CENTER){i.flexDirection==h.ROW?L(i,"width"):A(i,"width");return}}function a(i,t){if(t==l.STRETCH){H(i,"height");return}if(i.flexDirection==h.COLUMN){let e=O(i);if(!i.fitContent&&(i._growSum&&e>=0||e<0)){z();return}}if(t==l.TOP){if(i.flexDirection==h.COLUMN){w(i,"height");return}w(i,"height");return}if(t==l.BOTTOM){if(i.flexDirection==h.COLUMN){C(i,"height");return}C(i,"height");return}if(t==l.CENTER){i.flexDirection==h.COLUMN?L(i,"height"):A(i,"height");return}}function x(i,t,e){if(i.type=="Text"){if(i.height!=e)return;i.setWordWrapWidth(t),i.setFixedSize(t,e);return}i.setDisplaySize(t,e)}function d(i){y(i),i.setJustifyContent(i.justifyContent),i.setAlignItems(i.alignItems)}function J(i,t,e){let s=i.flexDirection==h.ROW,o=s?"width":"height",r=0;e>=0&&(r=t.flexGrow/i._growSum*e+t.basis),e<0&&(r=t.flexShrink*t.basis/i._basisSum*e+t.basis),s?x(t,r,t.height):x(t,t.width,r),t[o]=r}function N(i){let t=i.flexDirection==h.ROW?"width":"height",e=f[t],s=O(i),o=0,r=t=="width"?p(i):_(i);i.justifyContent==c.SPACE_AROUND?(o=s/(i.items.length+1),r+=i.padding+o):(o=s/(i.items.length-1),r+=i.padding),i.items.forEach(n=>{n.setOrigin(0,0),n[e](r),r+=n[t]+o+i.itemsMargin})}function y(i){let t=p(i),e=_(i);i._bounds={left:t+i.padding,right:t+i.width-i.padding,top:e+i.padding,bottom:e+i.height-i.padding}}var R=class{constructor(t){return this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.padding=t.padding||10,this.itemsMargin=t.itemsMargin||4,this.alignItems=t.alignItems||u.CENTER,this.flexDirection=t.flexDirection||h.ROW,this.justifyContent=t.justifyContent||c.FLEX_START,this.origin={x:0,y:0},this._scrollFactorX=0,this._scrollFactorY=0,this._fparent=null,this.items=[],this._isFlex=!0,this._basisSum=0,this._heights=[],this._widths=[],this._growSum=0,this._bounds={},(this.flexDirection==h.ROW&&!this.width||this.flexDirection==h.COLUMN&&!this.height)&&(this.fitContent=!0),this}add(t,e=0,s=1){return t.setOrigin(0,0),t.setScrollFactor(this._scrollFactorX,this._scrollFactorY),t._isFlex?(t.flexGrow=e,t.flexShrink=s,t._fparent=this):(t.flexGrow=0,t.flexShrink=0),this.width&&t.type=="Text"&&this.flexDirection==h.COLUMN&&W(this,t),t.basis=this.flexDirection==h.ROW?t.width:t.height,this._basisSum+=t.basis,this.items.push(t),this._heights.push(t.height),this._widths.push(t.width),this._growSum+=t.flexGrow,this.flexDirection==h.ROW&&(D(this,t.height),this.fitContent&&S(this,T(this))),this.flexDirection==h.COLUMN&&(S(this,t.width),this.fitContent&&D(this,T(this))),d(this),this._fparent&&this._fparent.setX(this._fparent.x),this}clear(){return this.items.forEach(t=>{t._isFlex&&t.clear(!0)}),this.items.forEach(t=>t.destroy()),this.items=[],this._heights=[],this._widths=[],this._basisSum=0,this}remove(t,e){if(this.items[t]==null)return;let s=this.items[t];return s._fparent=null,this._basisSum-=s.basis,this.items.splice(t,1),this._heights.splice(t,1),this._widths.splice(t,1),e&&s.destroy(),this.flexDirection==h.ROW&&U(this),this.flexDirection==h.COLUMN&&X(this),d(this),this}setDisplaySize(t,e){this.setWidth(t),this.setHeight(e)}destroy(){this.clear(!0),this.items=null,this._widths=null,this._heights=null,this._bounds=null,this.origin=null,this._fparent=null,this.destroyed=!0}setAlignItems(t){switch(this.alignItems==u.STRETCH&&t!=u.STRETCH&&(this.flexDirection==h.ROW?F(this):b(this)),this.alignItems=t,t){case u.CENTER:this.flexDirection==h.ROW?a(this,l.CENTER):g(this,l.CENTER);break;case u.FLEX_START:this.flexDirection==h.ROW?a(this,l.TOP):g(this,l.LEFT);break;case u.FLEX_END:this.flexDirection==h.ROW?a(this,l.BOTTOM):g(this,l.RIGHT);break;case u.STRETCH:this.flexDirection==h.ROW?a(this,l.STRETCH):g(this,l.STRETCH);break;default:break}return this}setFitContent(t){if(this.fitContent=t,t)if(this.flexDirection==h.ROW){let e=T(this)+2*this.padding;this.setWidth(e)}else{let e=T(this)+2*this.padding;this.setHeight(e)}return this}setHeight(t){return this.height=t,F(this),d(this),this}setWidth(t){if(this.width=t,b(this),this.flexDirection==h.COLUMN)for(let e=0;e<this.items.length;e++){let s=this.items[e];s.type=="Text"&&W(this,s)}return d(this),this}setJustifyContent(t){switch(this.justifyContent=t,t){case c.CENTER:this.flexDirection==h.ROW?g(this,l.CENTER):a(this,l.CENTER);break;case c.FLEX_START:this.flexDirection==h.ROW?g(this,l.LEFT):a(this,l.TOP);break;case c.FLEX_END:this.flexDirection==h.ROW?g(this,l.RIGHT):a(this,l.BOTTOM);break;case c.SPACE_AROUND:N(this);break;case c.SPACE_BETWEEN:N(this);break;default:break}return this}setOrigin(t,e){return e==null&&(e=t),this.origin.x=t,this.origin.y=e,t>1&&(this.origin.x=1),t<0&&(this.origin.x=0),e>1&&(this.origin.y=1),e<0&&(this.origin.y=0),d(this),this}setScrollFactor(t,e){t>1&&(t=1),t<0&&(t=0),e||(e=t),this._scrollFactorX=t,this._scrollFactorY=e;for(let s=0;s<this.items.length;s++)this.items[s].setScrollFactor(t,e);return this}setX(t){return this.x=t,d(this),this}setY(t){return this.y=t,d(this),this}};typeof window<"u"&&(globalThis.Fbx={Flex:R,AlignItems:u,FlexDirection:h,JustifyContent:c});})();
