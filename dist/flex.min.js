(()=>{var l={BOTTOM:1,CENTER:2,JUSTIFY:3,LEFT:4,RIGHT:5,STRETCH:6,TOP:7},u={CENTER:1,FLEX_END:2,FLEX_START:3,STRETCH:4},n={COLUMN:1,ROW:2},c={CENTER:1,FLEX_END:2,FLEX_START:3,SPACE_AROUND:4,SPACE_BETWEEN:5};var d={width:"setX",height:"setY"};function y(i,t){let e=d[t],s=t=="width"?C(i):x(i),o=i[t]/2+s;i.items.forEach(r=>{r.setOrigin(0,0);let h=o-r[t]/2;r[e](h)})}function H(i,t){let e=d[t],s=t=="width"?C(i):x(i),o=i[t]-2*i.padding,r=s+i.padding;i.items.forEach(h=>{h._isFlex&&(h.fitContent&&i.flexDirection!=h.flexDirection&&(h._fitContent=h.fitContent,h.fitContent=!1),h[e](r),h[t]>o&&(o=h[t]))}),i.items.forEach((h,T)=>{if(!h._isFlex)return;t=="width"?i._widths[T]=h[t]:i._heights[T]=h[t];let J=t=="width"?[o,h.height]:[h.width,o];_(h,...J)})}function M(i,t){return i=="width"&&t==n.ROW||i=="height"&&t==n.COLUMN}function p(i,t){let e=i.items,s=d[t],o=i._bounds[t=="width"?"right":"bottom"];for(let r=e.length-1;r>=0;r--){let h=e[r];h.setOrigin(0,0),h[s](o-h[t]),M(t,i.flexDirection)&&(o-=h[t]+i.itemsMargin)}}function L(i,t){let e=d[t],s=t=="width"?C(i):x(i),o=E(i),h=i[t]/2+s-o/2;i.items.forEach(T=>{T.setOrigin(0,0),T[e](h),h+=T[t]+i.itemsMargin})}function w(i,t){let e=d[t],s=i._bounds[t=="width"?"left":"top"];i.items.forEach(o=>{o.setOrigin(0,0),o[e](s),M(t,i.flexDirection)&&(s+=o[t]+i.itemsMargin)})}function I(i,t,e){let s=e+i.padding*2;s>i[t]&&(i[t]=s),A(i)}function D(i,t){I(i,"height",t)}function S(i,t){I(i,"width",t)}function k(i,t){let e=O(i),s=d[t],o=i._bounds[t=="width"?"left":"top"];i.items.forEach(r=>{G(i,r,e),r.setOrigin(0,0),r[s](o),o+=r[t]+i.itemsMargin})}function m(i){k(i,"width")}function B(i){k(i,"height")}function P(i,t){let e=i[`_${t}s`].length?Math.max(...i[`_${t}s`]):0;i[t]=e+2*i.padding,A(i)}function U(i){P(i,"height")}function F(i,t){let e=i.width-i.padding*2;t.setWordWrapWidth(e);let s=t.getBounds();t.setFixedSize(e,s.height)}function X(i){P(i,"width")}function O(i){return(i.flexDirection==n.ROW?i.width:i.height)-E(i)-2*i.padding}function E(i){let t=(i.items.length-1)*i.itemsMargin;return i._basisSum+t}function C(i){return i.x-i.width*i.origin.x}function x(i){return i.y-i.height*i.origin.y}function W(i){for(let t=0;t<i.items.length;t++){let e=i.items[t];_(e,e.width,i._heights[t]),e.height=i._heights[t]}}function b(i){for(let t=0;t<i.items.length;t++){let e=i.items[t];_(e,i._widths[t],e.height),e.width=i._widths[t]}}function z(i){i.items.forEach(t=>{t._isFlex&&(t.fitContent=t._fitContent)})}function g(i,t){if(t==l.STRETCH){H(i,"width");return}if(i.flexDirection==n.ROW){let e=O(i);if(!i.fitContent&&(i._growSum&&e>=0||e<0)){m(i);return}}if(t==l.LEFT){if(i.flexDirection==n.ROW){w(i,"width");return}w(i,"width");return}if(t==l.RIGHT){if(i.flexDirection==n.ROW){p(i,"width");return}p(i,"width");return}if(t==l.CENTER){i.flexDirection==n.ROW?L(i,"width"):y(i,"width");return}}function a(i,t){if(t==l.STRETCH){H(i,"height");return}if(i.flexDirection==n.COLUMN){let e=O(i);if(!i.fitContent&&(i._growSum&&e>=0||e<0)){B();return}}if(t==l.TOP){if(i.flexDirection==n.COLUMN){w(i,"height");return}w(i,"height");return}if(t==l.BOTTOM){if(i.flexDirection==n.COLUMN){p(i,"height");return}p(i,"height");return}if(t==l.CENTER){i.flexDirection==n.COLUMN?L(i,"height"):y(i,"height");return}}function _(i,t,e){if(i.type=="Text"){if(i.height!=e)return;i.setWordWrapWidth(t),i.setFixedSize(t,e);return}i.setDisplaySize(t,e)}function f(i){A(i),i.setJustifyContent(i.justifyContent),i.setAlignItems(i.alignItems)}function G(i,t,e){let s=i.flexDirection==n.ROW,o=s?"width":"height",r=0;e>=0&&(r=t.flexGrow/i._growSum*e+t.basis),e<0&&(r=t.flexShrink*t.basis/i._basisSum*e+t.basis),s?_(t,r,t.height):_(t,t.width,r),t[o]=r}function N(i){let t=i.flexDirection==n.ROW?"width":"height",e=d[t],s=O(i),o=0,r=t=="width"?C(i):x(i);i.justifyContent==c.SPACE_AROUND?(o=s/(i.items.length+1),r+=i.padding+o):(o=s/(i.items.length-1),r+=i.padding),i.items.forEach(h=>{h.setOrigin(0,0),h[e](r),r+=h[t]+o+i.itemsMargin})}function A(i){let t=C(i),e=x(i);i._bounds={left:t+i.padding,right:t+i.width-i.padding,top:e+i.padding,bottom:e+i.height-i.padding}}var R=class{constructor(t){return this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.padding=t.padding||10,this.itemsMargin=t.itemsMargin||4,this.alignItems=t.alignItems||u.CENTER,this.flexDirection=t.flexDirection||n.ROW,this.justifyContent=t.justifyContent||c.FLEX_START,this.origin={x:0,y:0},this._scrollFactorX=0,this._scrollFactorY=0,this._fparent=null,this.items=[],this._isFlex=!0,this._basisSum=0,this._heights=[],this._widths=[],this._growSum=0,this._bounds={},(this.flexDirection==n.ROW&&!this.width||this.flexDirection==n.COLUMN&&!this.height)&&(this.fitContent=!0),this._fitContent=this.fitContent,this}add(t,e=0,s=1){return t.setOrigin(0,0),t.setScrollFactor(this._scrollFactorX,this._scrollFactorY),t._isFlex?(t.flexGrow=e,t.flexShrink=s,t._fparent=this):(t.flexGrow=0,t.flexShrink=0),this.width&&t.type=="Text"&&this.flexDirection==n.COLUMN&&F(this,t),t.basis=this.flexDirection==n.ROW?t.width:t.height,this._basisSum+=t.basis,this.items.push(t),this._heights.push(t.height),this._widths.push(t.width),this._growSum+=t.flexGrow,this.flexDirection==n.ROW&&(D(this,t.height),this.fitContent&&S(this,E(this))),this.flexDirection==n.COLUMN&&(S(this,t.width),this.fitContent&&D(this,E(this))),f(this),this._fparent&&this._fparent.setX(this._fparent.x),this}clear(){return this.items.forEach(t=>{t._isFlex&&t.clear(!0)}),this.items.forEach(t=>t.destroy()),this.items=[],this._heights=[],this._widths=[],this._basisSum=0,this}remove(t,e){if(this.items[t]==null)return;let s=this.items[t];return s._fparent=null,this._basisSum-=s.basis,this.items.splice(t,1),this._heights.splice(t,1),this._widths.splice(t,1),e&&s.destroy(),this.flexDirection==n.ROW&&U(this),this.flexDirection==n.COLUMN&&X(this),f(this),this}setDisplaySize(t,e){this.setWidth(t),this.setHeight(e)}destroy(){this.clear(!0),this.items=null,this._widths=null,this._heights=null,this._bounds=null,this.origin=null,this._fparent=null,this.destroyed=!0}setAlignItems(t){switch(this.alignItems==u.STRETCH&&t!=u.STRETCH&&(this.flexDirection==n.ROW?W(this):b(this),z(this)),this.alignItems=t,t){case u.CENTER:this.flexDirection==n.ROW?a(this,l.CENTER):g(this,l.CENTER);break;case u.FLEX_START:this.flexDirection==n.ROW?a(this,l.TOP):g(this,l.LEFT);break;case u.FLEX_END:this.flexDirection==n.ROW?a(this,l.BOTTOM):g(this,l.RIGHT);break;case u.STRETCH:this.flexDirection==n.ROW?a(this,l.STRETCH):g(this,l.STRETCH);break;default:break}return this}setFitContent(t){if(this.fitContent=t,t)if(this.flexDirection==n.ROW){let e=E(this)+2*this.padding;this.setWidth(e)}else{let e=E(this)+2*this.padding;this.setHeight(e)}return this}setHeight(t){return this.height=t,W(this),f(this),this}setWidth(t){if(this.width=t,b(this),this.flexDirection==n.COLUMN)for(let e=0;e<this.items.length;e++){let s=this.items[e];s.type=="Text"&&F(this,s)}return f(this),this}setJustifyContent(t){switch(this.justifyContent=t,t){case c.CENTER:this.flexDirection==n.ROW?g(this,l.CENTER):a(this,l.CENTER);break;case c.FLEX_START:this.flexDirection==n.ROW?g(this,l.LEFT):a(this,l.TOP);break;case c.FLEX_END:this.flexDirection==n.ROW?g(this,l.RIGHT):a(this,l.BOTTOM);break;case c.SPACE_AROUND:N(this);break;case c.SPACE_BETWEEN:N(this);break;default:break}return this}setOrigin(t,e){return e==null&&(e=t),this.origin.x=t,this.origin.y=e,t>1&&(this.origin.x=1),t<0&&(this.origin.x=0),e>1&&(this.origin.y=1),e<0&&(this.origin.y=0),f(this),this}setScrollFactor(t,e){t>1&&(t=1),t<0&&(t=0),e||(e=t),this._scrollFactorX=t,this._scrollFactorY=e;for(let s=0;s<this.items.length;s++)this.items[s].setScrollFactor(t,e);return this}setX(t){return this.x=t,f(this),this}setY(t){return this.y=t,f(this),this}};typeof window<"u"&&(globalThis.Fbx={Flex:R,AlignItems:u,FlexDirection:n,JustifyContent:c});})();
